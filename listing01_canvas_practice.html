<html>
<head>
	<title>list01_canvas_practice</title>
</head>
<style type="text/css">
	canvas
	{
		background-color: black;
		width: 1024;
		height: 768;
	}
</style>
<script type="text/javascript">
	(function(){

		var canvas,
			gl;

		var vertexShader,
			fragmentShader,
			program;

		function init()
		{
			canvas = document.getElementById( "webgl_canvas" );

			initWebGL();
		}

		function initWebGL()
		{
			gl = canvas.getContext( "webgl" );

			gl.viewport( 0, 0, canvas.width, canvas.height );

			initBuffers();
			initShaders();

			(function render(){
				setUniforms();
				setAttributes();
				drawScene();

				requestAnimationFrame( render, canvas );
			})()
		}

		function setUniforms()
		{
				
		};

		function setAttributes()
		{
				
		};

		function drawScene()
		{
			
		};

		function initBuffers()
		{
			var r = 0.5;

			var vertices = 
			[
				-r, -r, 0.0,
				0, r, 0.0, 
				r, -r, 0.0
			];

			var vertexBuffer = gl.createBuffer();

			gl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );
			gl.bufferData( gl.ARRAY_BUFFER, new Float32Array( vertices ), gl.STATIC_DRAW );
		};

		function initShaders()
		{
			console.log( "a", document.getElementById( "vertex_source" ).innerHTML );
			vertexShader = makeShader( gl.VERTEX_SHADER, document.getElementById( "vertex_source" ).innerHTML );
			console.log( "b" );
			fragmentShader = makeShader( gl.FRAGMENT_SHADER, document.getElementById( "fragment_source" ).innerHTML );

			program = gl.createProgram();

			gl.attachShader( program, vertexShader );
			gl.attachShader( program, fragmentShader );
			gl.linkProgram( program );

			if( !gl.getProgramParameter( program, gl.LINK_STATUS ) )
			{
				console.log( "Link Shader to Programe Error log: " + gl.getProgramInfoLog( program ) );
			}

			gl.useProgram( program );
		}

		function makeShader( type, source )
		{
			var shader = gl.createShader( type );

			gl.shaderSource( shader, source );
			gl.compileShader( shader );

			if ( !gl.getShaderParameter( shader, gl.COMPILE_STATUS ) ) 
			{
				console.log( type + ") Make Shader Error log: " + gl.getShaderInfoLog( shader ) );
			} 

			return shader;
		}

		window.onload = init;

	})();
</script>

<script id="vertex_source" type="x-shader/x-vertex">
	attribute vec3 vertex;
	attribute vec3 vertexColor;

	uniform mat4 modelView;
	uniform mat4 projection;

	varying highp vec4 pixelColor;

	void main( void )
	{
		pixelColor = vec4( vertexColor, 1.0 );

		gl_Position = vec4( vertex, 1.0 );
	}
</script>

<script id="fragment_source" type="x-shader/x-fragment">
	
	//varying vec4 pixelColor;

	void main( void )
	{
		gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );//pixelColor;
	}

</script>

<body>
	<div class="wrapper">
		<canvas id="webgl_canvas">Your Browser doen`t support webgl</canvas>
	</div>
</body>
</html>

